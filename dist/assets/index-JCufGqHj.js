import{j as e,a as i}from"./index-BC6ZqUps.js";import{C as Y}from"./index-DWk-VP3O.js";import{A as be}from"./index-G2h_bwmS.js";import{b as P,q as X,D as W,v as G,w as J,x as Z,y as ee,A as ge,f as Ne,z as q,S as V}from"./index-DbdXof5P.js";import{c as S,Q as h,$ as E,U as H,K as _e,B as u,O as D,a0 as y,a as x,a1 as Ae,a2 as Ce,d as se,q as Ie,i as we,P as ae,f as Ke,y as Pe,j as Ee,J as te,a3 as De,X as Re,L as Te,E as N}from"./App-BMBn2WKP.js";import{z as n,B as R}from"./schema-AkqpuqDV.js";/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],ce=S("copy",ze);/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],Me=S("ellipsis",Be);/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],He=S("plus",Le);/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],ne=S("refresh-cw",Oe);/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Fe=S("trash-2",$e);n.object({merchantId:n.number()});const $=n.object({id:n.number(),key:n.string(),secret:n.string(),active:n.boolean(),createdAt:n.string(),expiredAt:n.string()}),Ye=n.array($);n.object({merchantId:n.number(),currentKey:n.string()});R.shape;n.object({currentKey:n.string()});n.object({key:n.string()});const qe=async s=>P.get(`/merchants/api-keys/${s.merchantId}`,{schema:Ye}),Ve=async s=>P.post("/merchants/api-keys/:merchantId",{data:s.merchantId,schema:$}),Ue=async s=>P.post("/merchants/api-keys/:merchantId/reissue",{data:s,schema:$}),Qe=async s=>P.delete(`/merchants/api-keys/${s.key}`,{schema:n.object({status:n.number()})}),I={get:qe,create:Ve,reissue:Ue,delete:Qe},Xe=s=>X({queryKey:h.API_KEYS.LIST,queryFn:()=>I.get({merchantId:s})}),We=n.object({sdkKey:n.string()}),Ge=R,Je=R,Ze=R,es=async()=>E.get("/sdk-key",{schema:We}),ss=async()=>E.post("/sdk-key/activate",{schema:Ge}),as=async()=>E.post("/sdk-key/deactivate",{schema:Je}),ts=async()=>E.post("/sdk-key/regenerate",{schema:Ze}),w={get:es,activate:ss,regenerate:ts,deactivate:as},cs=()=>X({queryKey:h.SDK.KEY,queryFn:()=>w.get()});function K({children:s,...t}){return e.jsx(e.Fragment,{children:s(H(t))})}var U="phuh9d0",re="phuh9d3",ie="phuh9d4",oe="phuh9d5",le="phuh9d6",ns="ua3qji1",rs="ua3qji2",is="ua3qji3",L="ua3qji4";const os=({isOpen:s,onRequestClose:t,onSubmit:a})=>e.jsx(W,{open:s,onOpenChange:t,children:e.jsxs(G,{style:{width:"460px"},children:[e.jsxs(J,{children:[e.jsx(Z,{children:"API 키 발급"}),e.jsx(ee,{children:"새로운 API 키를 발급하시겠어요? 발급된 키는 다시 발급할 수 없어요."}),e.jsxs("div",{className:ns,children:[e.jsxs("h2",{className:rs,children:[e.jsx(_e,{size:16}),"주의 사항"]}),e.jsxs("ul",{className:is,children:[e.jsx("li",{className:L,children:"API 키는 발급 후 즉시 사용 가능합니다."}),e.jsx("li",{className:L,children:"Secret 키는 최초 발급 시에만 확인 가능합니다."}),e.jsx("li",{className:L,children:"발급 후 반드시 안전한 곳에 보관하세요."})]})]})]}),e.jsxs(ge,{children:[e.jsx(u,{variant:"secondary",onClick:t,children:"취소"}),e.jsx(u,{variant:"primary",onClick:()=>{a(),t()},children:"발급하기"})]})]})}),ls=({userId:s})=>{const{openOverlay:t}=D();return e.jsx(K,{mutationKey:h.API_KEYS.CREATE,mutationFn:()=>I.create({merchantId:s}),onSuccess:()=>{y.success("API 키가 생성되었습니다.")},meta:{invalidates:[h.API_KEYS.LIST]},children:({mutate:a,isPending:r})=>e.jsx("div",{className:re,children:e.jsxs(u,{variant:"primary",className:ie,onClick:()=>t(c=>e.jsx(os,{...c,onSubmit:a})),disabled:r,children:[e.jsx(He,{size:16}),"API 키 발급"]})})})},de=()=>async({key:t,message:a})=>{await navigator.clipboard.writeText(t),y.success(a)};var ds="_1u0dzjg0",_="_1u0dzjg1",A="_1u0dzjg2",C="_1u0dzjg3",hs="_1u0dzjg4",us="_1u0dzjg5",ms="_1u0dzjg6",Q="_1u0dzjg7";const ys=({apiKey:s,isOpen:t,onRequestClose:a,onReissue:r,onDelete:c})=>{const{openConfirmation:o}=D(),l=d=>Ne(new Date(d),"yyyy/MM/dd");return e.jsx(W,{open:t,onOpenChange:a,children:e.jsxs(G,{style:{width:"460px"},children:[e.jsxs(J,{children:[e.jsx(Z,{children:"API 키 상세 정보"}),e.jsx(ee,{children:"API 키의 상세 정보를 확인할 수 있습니다."})]}),e.jsxs("div",{className:ds,children:[e.jsxs("div",{className:_,children:[e.jsx("span",{className:A,children:"ID"}),e.jsx("span",{className:C,children:s.key})]}),e.jsxs("div",{className:_,children:[e.jsx("span",{className:A,children:"상태"}),e.jsx("span",{className:`${C} ${s.active?hs:us}`,children:s.active?"활성":"비활성"})]}),e.jsxs("div",{className:_,children:[e.jsx("span",{className:A,children:"생성일"}),e.jsx("span",{className:C,children:l(s.createdAt)})]}),e.jsxs("div",{className:_,children:[e.jsx("span",{className:A,children:"만료일"}),e.jsx("span",{className:C,children:l(s.expiredAt)})]})]}),e.jsxs("div",{className:ms,children:[e.jsxs(u,{variant:"secondary",onClick:()=>{o({title:"API 키 재발급",body:"API 키를 재발급하시겠어요?",onSubmit:()=>{r(),a()}})},className:Q,children:[e.jsx(ne,{size:16}),"재발급"]}),e.jsxs(u,{variant:"destructive",onClick:()=>{o({title:"API 키 삭제",body:"API 키를 삭제하시겠어요?",onSubmit:()=>{c(),a()}})},className:Q,children:[e.jsx(Fe,{size:16}),"삭제"]})]})]})})};var xs="_4400xy0",ps="_4400xy1",js="_4400xy2",vs="_4400xy3",Ss="_4400xy4",ks="_4400xy5",fs="_4400xy6";const he=i.forwardRef(({className:s,...t},a)=>e.jsx("div",{className:xs,children:e.jsx("table",{ref:a,className:x(ps,s),...t})}));he.displayName="Table";const bs=i.forwardRef(({className:s,...t},a)=>e.jsx("thead",{ref:a,className:x(js,s),...t}));bs.displayName="TableHeader";const ue=i.forwardRef(({className:s,...t},a)=>e.jsx("tbody",{ref:a,className:x(vs,s),...t}));ue.displayName="TableBody";const O=i.forwardRef(({className:s,...t},a)=>e.jsx("tr",{ref:a,className:x(Ss,s),...t}));O.displayName="TableRow";const gs=i.forwardRef(({className:s,...t},a)=>e.jsx("th",{ref:a,className:x(ks,s),...t}));gs.displayName="TableHead";const j=i.forwardRef(({className:s,...t},a)=>e.jsx("td",{ref:a,className:x(fs,s),...t}));j.displayName="TableCell";const Ns=({apiKeyList:s,userId:t})=>{const{openOverlay:a}=D(),r=de();return e.jsx(he,{children:e.jsx(ue,{children:s.length>0?s.map(c=>e.jsxs(O,{children:[e.jsx(j,{children:c.id}),e.jsx(j,{children:e.jsxs("div",{className:oe,children:[e.jsx("span",{children:c.key}),e.jsx(u,{variant:"ghost",size:"sm",onClick:()=>r({key:c.key,message:"API 키가 복사되었습니다."}),className:le,children:e.jsx(ce,{size:16})})]})}),e.jsx(j,{children:e.jsx(_s,{apiKey:c})}),e.jsx(j,{children:e.jsx(K,{mutationKey:h.API_KEYS.REISSUE,mutationFn:()=>I.reissue({merchantId:t,currentKey:c.key}),onSuccess:()=>{y.success("API 키가 재발급되었습니다.")},meta:{invalidates:[h.API_KEYS.LIST]},children:({mutate:o})=>e.jsx(K,{mutationKey:h.API_KEYS.DELETE,mutationFn:()=>I.delete({key:c.key}),onSuccess:()=>{y.success("API 키가 삭제되었습니다.")},meta:{invalidates:[h.API_KEYS.LIST]},children:({mutate:l})=>e.jsx(u,{variant:"ghost",size:"sm",onClick:()=>a(d=>e.jsx(ys,{...d,apiKey:c,onReissue:()=>o(),onDelete:()=>l()})),children:e.jsx(Me,{size:16})})})})})]},c.id)):e.jsx(O,{children:e.jsx(j,{colSpan:4,style:{textAlign:"center"},children:"발급된 API 키가 없습니다."})})})})},_s=({apiKey:s})=>{const[t,a]=i.useState({}),r=o=>{a(l=>({...l,[o]:!l[o]}))},c=(o,l)=>{if(l)return o;const d=8,m=o.slice(0,d),v=o.slice(d).replace(/[^_]/g,"•");return m+v};return e.jsxs("div",{className:oe,children:[e.jsx("span",{children:c(s.secret,t[s.id])}),e.jsx(u,{variant:"ghost",size:"sm",onClick:()=>r(s.id),className:le,children:t[s.id]?e.jsx(Ae,{size:16}):e.jsx(Ce,{size:16})})]})};var T="Switch",[As,Xs]=we(T),[Cs,Is]=As(T),me=i.forwardRef((s,t)=>{const{__scopeSwitch:a,name:r,checked:c,defaultChecked:o,required:l,disabled:d,value:m="on",onCheckedChange:v,form:p,...z}=s,[k,f]=i.useState(null),B=se(t,g=>f(g)),M=i.useRef(!1),F=k?p||!!k.closest("form"):!0,[b,ke]=Ie({prop:c,defaultProp:o??!1,onChange:v,caller:T});return e.jsxs(Cs,{scope:a,checked:b,disabled:d,children:[e.jsx(ae.button,{type:"button",role:"switch","aria-checked":b,"aria-required":l,"data-state":je(b),"data-disabled":d?"":void 0,disabled:d,value:m,...z,ref:B,onClick:Ke(s.onClick,g=>{ke(fe=>!fe),F&&(M.current=g.isPropagationStopped(),M.current||g.stopPropagation())})}),F&&e.jsx(pe,{control:k,bubbles:!M.current,name:r,value:m,checked:b,required:l,disabled:d,form:p,style:{transform:"translateX(-100%)"}})]})});me.displayName=T;var ye="SwitchThumb",xe=i.forwardRef((s,t)=>{const{__scopeSwitch:a,...r}=s,c=Is(ye,a);return e.jsx(ae.span,{"data-state":je(c.checked),"data-disabled":c.disabled?"":void 0,...r,ref:t})});xe.displayName=ye;var ws="SwitchBubbleInput",pe=i.forwardRef(({__scopeSwitch:s,control:t,checked:a,bubbles:r=!0,...c},o)=>{const l=i.useRef(null),d=se(l,o),m=Pe(a),v=Ee(t);return i.useEffect(()=>{const p=l.current;if(!p)return;const z=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(z,"checked").set;if(m!==a&&f){const B=new Event("click",{bubbles:r});f.call(p,a),p.dispatchEvent(B)}},[m,a,r]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a,...c,tabIndex:-1,ref:d,style:{...c.style,...v,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});pe.displayName=ws;function je(s){return s?"checked":"unchecked"}var ve=me,Ks=xe,Ps=te({defaultClassName:"_1myt0jc0",variantClassNames:{size:{sm:"_1myt0jc1",md:"_1myt0jc2",lg:"_1myt0jc3"}},defaultVariants:{size:"md"},compoundVariants:[]}),Es=te({defaultClassName:"_1myt0jc4",variantClassNames:{size:{sm:"_1myt0jc5",md:"_1myt0jc6",lg:"_1myt0jc7"}},defaultVariants:{size:"md"},compoundVariants:[]});const Se=i.forwardRef(({className:s,size:t,...a},r)=>e.jsx(ve,{className:x(Ps({size:t}),s),...a,ref:r,children:e.jsx(Ks,{className:Es({size:t}),style:{transform:a.checked?"translateX(100%)":"translateX(0)"}})}));Se.displayName=ve.displayName;var Ds="_16ai97h1",Rs="_16ai97h2",Ts="_16ai97h3",zs="_16ai97h4",Bs="_16ai97h9",Ms="_16ai97ha",Ls="_16ai97hb",Hs="_16ai97hc";const Os=({sdkKey:s})=>{const t=de(),[a,r]=i.useState(!0),{mutate:c}=H({mutationFn:()=>w.activate(),onSuccess:()=>{r(!0),y.success("SDK 키가 활성화되었습니다.")}}),{mutate:o}=H({mutationFn:()=>w.deactivate(),onSuccess:()=>{r(!1),y.success("SDK 키가 비활성화되었습니다.")}}),l=d=>{d?c():o()};return e.jsx("div",{className:Ds,children:e.jsxs("div",{className:Rs,children:[e.jsx(De,{children:"SDK 키"}),e.jsxs("div",{className:Ts,children:[e.jsx(Re,{value:s,readOnly:!0,suffix:e.jsx(u,{variant:"ghost",size:"sm",onClick:()=>t({key:s,message:"SDK 키가 복사되었습니다."}),disabled:!a,children:e.jsx(ce,{size:16})}),disabled:!a,className:zs}),e.jsxs("div",{className:Bs,children:[e.jsx("div",{className:`${Ms} ${a?Ls:Hs}`,children:a?"활성":"비활성"}),e.jsx(Se,{size:"lg",checked:a,onCheckedChange:l,"aria-label":"SDK 키 상태 토글"})]})]})]})})},$s=()=>{const{openConfirmation:s}=D();return e.jsx(K,{mutationKey:h.SDK.REGENERATE,mutationFn:()=>w.regenerate(),onSuccess:()=>{y.success("SDK 키가 재발급되었습니다.")},meta:{invalidates:[h.SDK.KEY]},children:({mutate:t,isPending:a})=>e.jsx("div",{className:re,children:e.jsxs(u,{variant:"secondary",className:ie,onClick:()=>s({title:"SDK 키 재발급",body:"SDK 키를 재발급하시겠어요?",onSubmit:()=>t()}),disabled:a,children:[e.jsx(ne,{size:16}),"재발급"]})})})},Ws=()=>{const s=Te();return e.jsxs(be,{label:"API 키",children:[e.jsx(i.Suspense,{fallback:e.jsx(N,{width:"100%",height:"250px",children:e.jsx(V,{})}),children:e.jsx(q,{...cs(),children:({data:t})=>e.jsxs(N,{className:U,children:[e.jsx(Y,{title:"결제위젯 연동 키",description:"결제 위젯으로 연동할 때 사용하는 SDK 키에요. 회원가입 시 자동으로 발급돼요.",action:e.jsx($s,{})}),e.jsx(Os,{sdkKey:t.sdkKey})]})})}),e.jsx(i.Suspense,{fallback:e.jsx(N,{width:"100%",height:"300px",children:e.jsx(V,{})}),children:s!==null?e.jsx(q,{...Xe(s),children:({data:t})=>e.jsxs(N,{className:U,children:[e.jsx(Y,{title:"API 개별 연동 키",description:"결제 시스템과 연동하기 위한 API 키를 관리해요.",action:e.jsx(ls,{userId:s})}),e.jsx(Ns,{apiKeyList:t,userId:s})]})}):null})]})};export{Ws as default};
